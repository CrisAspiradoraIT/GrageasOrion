<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Apertura de Grageas</title>
  <style>
    body {
      min-height: 100vh;
      font-family: 'Merriweather', serif;
      background-color: #18263a;
      background-image: url('https://www.transparenttextures.com/patterns/brick-wall.png');
      /* Brick wall texture, puedes buscar otra si prefieres */
      color: #f4e7d0;
      padding: 2em;
      position: relative;
      box-sizing: border-box;
    }
    h1 {
      color: #ffe082;
      letter-spacing: 2px;
      text-shadow: 2px 2px 8px #000, 0 0 16px #ffe08299;
      font-family: 'Cinzel', serif;
      text-align: center;
      margin-top: 60px;
    }
    .gragea-container {
      border: 2px solid #ffe082;
      border-radius: 10px;
      background: rgba(20, 24, 40, 0.98);
      padding: 1em 2em;
      margin-bottom: 1.5em;
      max-width: 400px;
      box-shadow: 2px 2px 14px #000a;
      margin-left: auto;
      margin-right: auto;
    }
    label {
      font-weight: bold;
      color: #ffe082;
    }
    select {
      width: 100%;
      margin-bottom: 1em;
      padding: 0.3em;
      font-size: 1em;
      background: #212e47;
      color: #ffe082;
      border: 1px solid #ffe082;
      border-radius: 5px;
    }
    button {
      background: #ffe082;
      color: #18263a;
      padding: 0.6em 1.5em;
      border: none;
      border-radius: 5px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      margin-top: 1em;
      box-shadow: 0 2px 8px #0007;
      transition: background 0.3s;
    }
    button:hover {
      background: #ffe082cc;
    }
    .msg-box, .result {
      background: rgba(32, 40, 60, 0.97);
      border-radius: 8px;
      padding: 1em;
      margin-top: 2em;
      font-size: 1.1em;
      word-break: break-word;
      white-space: pre-line;
      box-shadow: 0 2px 16px #0008;
      color: #ffe082;
    }
    .msg-box {
      border: 2px dashed #ffe08277;
      position: relative;
    }
    .copy-btn {
      position: absolute;
      top: 1em;
      right: 1em;
      background: #a8845c;
      color: #fff;
      padding: 0.3em 1em;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.95em;
    }
    .premio {
      color: #ffe082;
      font-weight: bold;
    }
    .gragea-container { display: none; }
    .gragea-container.active { display: block; }
    .gragea-selector {
      margin-bottom: 2em;
      font-size: 1.1em;
      text-align: center;
    }
    .gragea-selector label {
      font-weight: normal;
      margin-right: 1em;
      color: #ffe082;
    }
    #grageasForm { display: none; }
    .result-title {
      margin: 2em 0 0.5em 0;
      font-weight: bold;
      font-size: 1.2em;
      color: #ffe082;
      letter-spacing: 1px;
      text-align: center;
    }
    /* Lámparas */
    .lampara {
      position: fixed;
      width: 72px;
      height: 120px;
      z-index: 100;
      top: 10px;
      pointer-events: none;
    }
    .lampara.left { left: 35px; }
    .lampara.right { right: 35px; transform: scaleX(-1);}
    .lampara .luz {
      transition: opacity 1s;
      opacity: 1;
      will-change: opacity;
    }
    @media (max-width: 600px) {
      .lampara { width: 40px; height: 66px; top: 10px;}
      .lampara.left { left: 6px;}
      .lampara.right { right: 6px;}
    }
  </style>
  <!-- Google Fonts para un toque mágico -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Merriweather&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Lámparas SVG -->
  <div class="lampara left">
    <svg width="72" height="120" viewBox="0 0 72 120" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect x="28" y="4" width="16" height="36" rx="8" fill="#222"/>
      <ellipse cx="36" cy="52" rx="25" ry="23" fill="#aaa" />
      <ellipse cx="36" cy="52" rx="17" ry="19" fill="#ffe082" class="luz" id="luz-izq"/>
      <ellipse cx="36" cy="52" rx="14" ry="16" fill="#fff8dc44"/>
      <rect x="32" y="80" width="8" height="30" rx="4" fill="#b69e74"/>
      <rect x="33" y="110" width="6" height="8" rx="3" fill="#ffe082"/>
    </svg>
  </div>
  <div class="lampara right">
    <svg width="72" height="120" viewBox="0 0 72 120" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect x="28" y="4" width="16" height="36" rx="8" fill="#222"/>
      <ellipse cx="36" cy="52" rx="25" ry="23" fill="#aaa" />
      <ellipse cx="36" cy="52" rx="17" ry="19" fill="#ffe082" class="luz" id="luz-der"/>
      <ellipse cx="36" cy="52" rx="14" ry="16" fill="#fff8dc44"/>
      <rect x="32" y="80" width="8" height="30" rx="4" fill="#b69e74"/>
      <rect x="33" y="110" width="6" height="8" rx="3" fill="#ffe082"/>
    </svg>
  </div>
  <h1>Apertura de Grageas</h1>
  
  <div class="gragea-selector">
    <label>¿Cuántas grageas quieres abrir?
      <select id="grageaCount">
        <option value="" selected disabled>Elige una opción</option>
        <option value="1">1 gragea</option>
        <option value="2">2 grageas</option>
        <option value="3">3 grageas</option>
      </select>
    </label>
  </div>
  
  <form id="grageasForm">
    <div class="gragea-container" id="gragea-box-1">
      <label>Gragea 1:</label>
      <select name="gragea1-sabor1" required></select>
      <select name="gragea1-sabor2" required></select>
      <select name="gragea1-sabor3" required></select>
    </div>
    <div class="gragea-container" id="gragea-box-2">
      <label>Gragea 2:</label>
      <select name="gragea2-sabor1" required></select>
      <select name="gragea2-sabor2" required></select>
      <select name="gragea2-sabor3" required></select>
    </div>
    <div class="gragea-container" id="gragea-box-3">
      <label>Gragea 3:</label>
      <select name="gragea3-sabor1" required></select>
      <select name="gragea3-sabor2" required></select>
      <select name="gragea3-sabor3" required></select>
    </div>
    <button type="submit">Abrir Grageas</button>
  </form>

  <!-- Mensaje bonito para copiar -->
  <div class="msg-box" id="msgBox" style="display:none;position:relative;">
    <button class="copy-btn" id="copyBtn" title="Copiar mensaje">Copiar</button>
    <span id="msgContent"></span>
  </div>

  <!-- Resultados -->
  <div class="result-title" id="resultTitle" style="display:none;">RESULTADOS</div>
  <div class="result" id="result" style="display:none;"></div>

  <script>
    // Solo el emoji
    function extraerEmojis(sabor) {
      const regexEmoji = /([\p{Emoji_Presentation}\p{Extended_Pictographic}\uFE0F][\u200D\u2640-\u2642\uFE0F]*\s*)+$/gu;
      let match = sabor.match(regexEmoji);
      return match ? match[0].trim() : sabor;
    }

    const sabores = [
      "Aceitunas 🫒", "Ajo crudo 🧄", "Alga marina 🪸", "Aliento de dragón 🐉🌬", "Aliento de ogro 🧌",
      "Algodón de azúcar 🍭", "Arándanos 🫐", "Baba de caracol 🐌", "Bellini 🥂", "Beso no correspondido 💋💔",
      "Biberón 🍼", "Blody Mary 🫗🩸", "Brillo labial 💋💄", "Burrito 🌯", "Cacahuate 🥜", "Caña de azúcar 🎋",
      "Canela en polvo 🍂", "Cáscara de plátano 🍌", "Café frío ☕", "Café quemado ☕🔥", "Caldo de murciélago 🦇🍲",
      "Cebolla caramelizada 🧅", "Cereza 🍒", "Cerveza 🍺", "Chicle de menta 🍬", "Chisme express🫦☕",
      "Chorizo 🥩", "Cítricos 🍋", "Coco 🥥", "Cóctel 🍸", "Coliflor cruda 🥦", "Cera de oído 👂",
      "Champaña 🥂", "Chocolate 🍫", "Cupcake 🧁", "Donas 🍩", "Drama queen 👑💅🏼", "Dulce de leche 🥮",
      "Dumpling 🥟", "Durazno 🍑", "Ensalada 🥗", "Esencia de mandrágora 🌱", "Espinaca cocida 🍲",
      "Espuma de mar 🌊", "Estiércol de dragón 🐉💩", "Ex 👅", "Exponme 👀🔮", "Flor de cactus 🌵", "Frutilla 🍓",
      "Galleta de avena 🍪", "Gelatina de sapo 🐸", "Guisado 🍛", "Guisantes triturados 🫛", "Helado de calabaza 🎃",
      "Helado de vainilla 🍨", "Hielo 🧊", "Hojas secas 🍁", "Hueso dragón tostado 🦴", "Huevo frito 🍳",
      "Huevo podrido 🥚", "Jarabe de arce 🍯", "Jugo de pepino 🥒", "Kiwi 🥝", "Leche 🐮", "Leche caducada 🥛",
      "Leche podrida 🧋", "Lo juro ✋🏻", "Manteca de maní 🥜", "Manteca rancia 🧈", "Margarita 🍸", "Martini 🍸",
      "Mate 🧉", "Menta 🌿", "Mezcla de hongos 🍄", "Mermelada de escarabajo 🪲", "Moco 🦠", "Naruto 🍥",
      "Negroni 🥃", "Onigiri 🍙", "Ostras vivas 🦪", "Pan con hongos 🫓", "Papas fritas 🍟", "Pasta de dientes 🪥",
      "Pasta pegajosa 🍝", "Pastel 🍰", "Pepino 🥒", "Picante 🌶", "Pie de manzana 🥧", "Pimiento asado 🫑",
      "Piña colada 🍹", "Pizza 🍕", "Pollo asado 🍗", "Polvos mágicos ✨", "Pudín 🍮", "Queso mohoso 🧀",
      "Redflag 🚩", "Raíz de mandrágora 🌱", "Ron añejo 🍾", "Sal marina 🧂", "Sandía 🍉", "Sangre 🩸",
      "Sangre de unicornio 🦄", "Sangre de unicornio oxidada 🦄", "Sardinas enlatadas 🐟", "Sexo en la playa 🥃🏖",
      "Soju 🍶", "Sopa de pescado 🍵", "Sopa de pescado en mal estado 🍵", "Spaguetti 🍝", "Sudor 💦",
      "Sudor de troll 🧟‍♂💦", "Sushi 🍣", "Tacos 🌮", "Tamal 🫔", "Te negro 🫖🖤", "Tinta de pulpo 🐙",
      "Trigo seco 🌾", "Tronco podrido 🪵", "Tocino 🥓", "Vino 🍷", "Vómito 🤮", "Waffles 🧇", "Whisky ⁠🥃"
    ];

    const premios = [
      "Saeta de fuego 🔥🧹", "Nimbus 2000 🪽🧹", "Detonadores trampa 🪤", "Mapa del merodeador 🗺",
      "Anillo de Morfín Gaunt 💍", "Varita de saúco 🪄💀", "El desiluminador 💡", "Pergamino mágico 📜",
      "El traslador 🔮", "Carta vociferadora 💌", "Giratiempo ⏱", "Félix felicis 🍀🧪", "Pluma de Hermione 🪶",
      "Amortentia 💘🧪", "Pastillas vomitivas 💊", "Ranita Amarilla 💛🍫", "Ranita verde 💚🍫", "Ranita roja ❤🍫",
      "Ranita negra 🖤🍫", "Ranita rosa 🩷🍫", "Ranita lila 💜🍫", "Ranita naranja 🧡🍫", "Ranita celeste 🩵🍫",
      "Gragea de todos los sabores 🫘", "Puedes robarle 10.000G en el caldero 🪙", "-10.000G 🪙", "-5.000G 🪙",
      "-2.000G 🪙", "-500G 🪙", "-1.500G 🪙", "-8.000p", "-7.000p", "+8.000G 🪙", "+5.000G 🪙", "+3.000G 🪙",
      "+1.500G 🪙", "-10.000p", "+2 ranitas a elección", "Se te restan dos productos de tu inventario (al azar)",
      "+10.000p", "+8.000p", "+5.000p", "Puedes robarle 10.000p a alguien", "Puedes robarle 8.000p a alguien",
      "Puedes robarle 5.000p a alguien", "Pierdes 3 objetos de tu inventario (al azar)",
      "Tienes la posibilidad de elegir entre dos cosas ocultas", "Debes donarle 5.000G a alguien 🪙",
      "Puedes restarle 5.000p a un compañero", "Puedes sumarle 5.000p a un compañero", "+3 ranitas a elección",
      "Se restan 3 productos a eleccion", "Se restan dos productos a elección", "Espejo de Oesed 🪞",
      "La recordadora de Neville 🎱"
    ];

    // Llena los selects de grageas con la lista de sabores (excepto el selector de cantidad)
    document.querySelectorAll('.gragea-container select').forEach(select => {
      sabores.forEach(sabor => {
        const option = document.createElement('option');
        option.value = sabor;
        option.innerText = sabor;
        select.appendChild(option);
      });
    });

    // Mostrar solo los campos de las grageas elegidas y el formulario después de seleccionar cantidad
    function actualizarGrageas() {
      const cuantas = parseInt(document.getElementById('grageaCount').value, 10);
      const form = document.getElementById('grageasForm');
      if (isNaN(cuantas)) {
        form.style.display = 'none';
        document.getElementById('result').style.display = 'none';
        document.getElementById('resultTitle').style.display = 'none';
        document.getElementById('msgBox').style.display = 'none';
        return;
      } else {
        form.style.display = 'block';
      }
      for (let i = 1; i <= 3; i++) {
        const box = document.getElementById('gragea-box-' + i);
        if (i <= cuantas) {
          box.classList.add('active');
          box.querySelectorAll('select').forEach(sel => sel.required = true);
        } else {
          box.classList.remove('active');
          box.querySelectorAll('select').forEach(sel => sel.required = false);
        }
      }
      // Limpiar resultado y mensaje bonito al cambiar cantidad
      document.getElementById('result').style.display = 'none';
      document.getElementById('resultTitle').style.display = 'none';
      document.getElementById('msgBox').style.display = 'none';
    }

    document.getElementById('grageaCount').addEventListener('change', actualizarGrageas);

    // Función para obtener premio aleatorio
    function premioAleatorio() {
      return premios[Math.floor(Math.random() * premios.length)];
    }

    // Al hacer submit, muestra el resultado con premios aleatorios y el mensaje bonito
    document.getElementById('grageasForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const cuantas = parseInt(document.getElementById('grageaCount').value, 10);

      // Mensaje bonito
      let msg = "⋆ ————————✧◦🍻◦✧———————— ⋆\n\n";
      msg += "╰┈➤ ɢʀᴀɢᴇᴀ ᴅᴇ ᴛᴏᴅᴏꜱ ʟᴏꜱ ꜱᴀʙᴏʀᴇꜱ 🫘\n\n";
      let premiosPorGragea = [];
      for (let i = 1; i <= cuantas; i++) {
        let trio = [];
        for (let j = 1; j <= 3; j++) {
          const sabor = this[`gragea${i}-sabor${j}`].value;
          const premio = premioAleatorio();
          trio.push({sabor, premio});
        }
        premiosPorGragea.push(trio);
      }
      premiosPorGragea.forEach((trio, idx) => {
        msg += `Gragea ${idx + 1}\n`;
        trio.forEach(par => {
          msg += `${extraerEmojis(par.sabor)} ⟶ ${par.premio}\n\n`;
        });
      });
      msg += "⋆ ————————✧◦🍻◦✧———————— ⋆";

      document.getElementById('msgContent').innerText = msg;
      document.getElementById('msgBox').style.display = 'block';

      // Resultados con premios
      let resultado = "";
      premiosPorGragea.forEach((trio, i) => {
        resultado += `<strong>Gragea ${i+1}:</strong><br>`;
        trio.forEach(par => {
          resultado += `${par.sabor} <br><span class="premio">Premio: ${par.premio}</span><br>`;
        });
        resultado += "<br>";
      });
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = resultado;
      resultDiv.style.display = 'block';
      document.getElementById('resultTitle').style.display = 'block';
    });

    // Copiar mensaje bonito al portapapeles
    document.getElementById('copyBtn').addEventListener('click', function() {
      const text = document.getElementById('msgContent').innerText;
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          this.innerText = "¡Copiado!";
          setTimeout(() => { this.innerText = "Copiar"; }, 1200);
        });
      } else { // fallback
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        this.innerText = "¡Copiado!";
        setTimeout(() => { this.innerText = "Copiar"; }, 1200);
      }
    });

    // Inicialmente ocultar el formulario
    actualizarGrageas();

    // Animación de titileo lámparas cada 10 segundos
    function titilarLamparas() {
      let l1 = document.getElementById('luz-izq');
      let l2 = document.getElementById('luz-der');
      if (!l1 || !l2) return;
      l1.style.opacity = '0.3';
      l2.style.opacity = '0.3';
      setTimeout(() => {
        l1.style.opacity = '1';
        l2.style.opacity = '1';
      }, 800);
    }
    setInterval(titilarLamparas, 10000);
  </script>
</body>
</html>
